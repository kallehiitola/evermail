---
description: MCP tool usage for Microsoft Learn and Stripe - ALWAYS use these for official documentation
alwaysApply: true
---

# MCP Tool Usage - CRITICAL

## Available MCP Tools

You have access to the following MCP servers:
1. **Microsoft Learn MCP** - Microsoft/Azure documentation
2. **Context7 MCP** - Library documentation (MudBlazor, MimeKit, Azure SDKs)
3. **Stripe MCP** - Payment processing operations
4. **Azure Pricing MCP** - Real-time Azure service pricing and cost estimation
5. **GitKraken MCP** - Git operations, branch management, commit history, PR management
5. **Framer MCP** - Marketing website design (NOT the Blazor application)

## Querying Microsoft Documentation

You have access to MCP tools called `microsoft_docs_search`, `microsoft_docs_fetch`, and `microsoft_code_sample_search` - these tools allow you to search through and fetch Microsoft's latest official documentation and code samples, and that information might be more detailed or newer than what's in your training data set.

**ALWAYS use these tools when dealing with Microsoft technologies:**

### Microsoft Learn MCP Tools

**When to Use**:
- Questions about C#, F#, ASP.NET Core, .NET 8+
- Azure services (Azure Aspire, Container Apps, SQL, Blob Storage, Functions)
- Microsoft.Extensions libraries
- Entity Framework Core
- NuGet packages
- Azure CLI commands
- Any Microsoft/Azure best practices

**Available Tools**:
1. `microsoft_docs_search` - Search Microsoft Learn documentation
2. `microsoft_docs_fetch` - Fetch full documentation page as markdown
3. `microsoft_code_sample_search` - Find official Microsoft code samples

**Example Prompts**:
```
"Give me the Azure CLI commands to create an Azure Container App with a managed identity. search Microsoft Learn"

"Is the latest .NET 9 compatible with Azure App Service? fetch full doc"

"Show me the official way to implement IHttpClientFactory in .NET 8 minimal API. search Microsoft Learn and fetch full doc"

"I need to understand Azure Functions end-to-end. search Microsoft Learn and deep dive"

"What's the best practice for EF Core migrations in production? search Microsoft Learn"
```

### Usage Pattern

For Evermail project specifically:

1. **Azure Aspire Setup**
   ```
   "Show me the latest Azure Aspire configuration for SQL Server and Blob Storage. search Microsoft Learn and fetch full doc"
   ```

2. **Azure SQL Serverless**
   ```
   "What are the best practices for Azure SQL Serverless connection pooling? search Microsoft Learn"
   ```

3. **Blazor WebAssembly**
   ```
   "Show me the official Blazor WASM authentication patterns with JWT. search Microsoft Learn and fetch full doc"
   ```

4. **Entity Framework Core**
   ```
   "What's the recommended way to implement global query filters in EF Core 8? search Microsoft Learn"
   ```

5. **Azure Container Apps**
   ```
   "How do I configure auto-scaling for Azure Container Apps? search Microsoft Learn and fetch full doc"
   ```

## Querying Library Documentation with Context7

You have access to Context7 MCP for up-to-date documentation on any library or framework. **ALWAYS use Context7 for library-specific questions**.

### Context7 MCP Tools

**When to Use**:
- MudBlazor component documentation
- ASP.NET Core libraries
- Entity Framework Core
- Azure SDKs (when more detailed than Microsoft Learn)
- MimeKit email parsing
- Any NuGet package or JavaScript library
- Code examples and setup guides

**Available Tools**:
1. `resolve-library-id` - Find the Context7 ID for a library
2. `get-library-docs` - Get documentation for a specific library

**Example Prompts**:
```
"How do I use MudBlazor's MudDataGrid component? use context7"

"Show me MimeKit examples for parsing email attachments. use context7"

"Configure Azure.Storage.Blobs for connection pooling. use context7"

"Implement Entity Framework Core global query filters. use context7"

"How do I use the Stripe.NET SDK for subscriptions? use context7"
```

### Library-Specific Usage for Evermail

**MudBlazor UI Components**:
```
"Create a MudBlazor form with validation. use library /mudblazor/mudblazor"

"How do I implement MudTable with server-side pagination? use context7"
```

**MimeKit Email Parsing**:
```
"Parse mbox file with MimeKit streaming. use library /jstedfast/mimekit"

"Extract email attachments with MimeKit. use context7"
```

**Entity Framework Core**:
```
"Implement EF Core compiled queries for performance. use context7"

"Set up EF Core migrations with Azure SQL. use context7"
```

**Azure SDKs**:
```
"Use Azure.Storage.Blobs for file upload. use context7"

"Configure Azure.Storage.Queues for background jobs. use context7"
```

## Querying Stripe Documentation

You have access to Stripe MCP tools for payment integration. **ALWAYS use these tools for Stripe-related questions**.

### Stripe MCP Tools

**When to Use**:
- Payment processing questions
- Subscription management
- Customer creation and management
- Webhook handling
- Invoice generation
- Payment intents
- Checkout sessions
- Stripe API questions

**Available Tools** (from @stripe/mcp):
- Customer management (create, list, retrieve)
- Payment intents (create, retrieve, confirm)
- Charges (list, retrieve)
- Subscriptions (create, update, cancel, list)
- Products & Prices (create, list)
- Invoices (create, list, finalize)
- Refunds (create)
- Payment methods
- And more...

**Example Prompts**:
```
"Show me my Stripe test customers"

"How do I create a subscription with a 7-day trial using Stripe?"

"What's the correct way to verify Stripe webhook signatures in C#?"

"Create a test payment intent for €9 EUR"

"List my Stripe products and their prices"
```

### Usage Pattern for Evermail

1. **Creating Subscription Plans**
   ```
   "Create Stripe products for Evermail Free, Pro, Team, and Enterprise tiers"
   ```

2. **Webhook Verification**
   ```
   "How do I verify Stripe webhook signatures in ASP.NET Core?"
   ```

3. **Customer Portal**
   ```
   "Generate a Stripe customer portal session for user management"
   ```

4. **Metered Billing**
   ```
   "How do I implement usage-based billing with Stripe for AI features?"
   ```

## Critical: Always Prefer Official Documentation

### For Microsoft Technologies
- ✅ **DO**: Use Microsoft Learn MCP tools first
- ✅ **DO**: Verify your suggestions against official docs
- ✅ **DO**: Fetch full documentation when implementing complex features
- ❌ **DON'T**: Rely solely on training data for Microsoft tech
- ❌ **DON'T**: Guess at API changes or new features

### For Library-Specific Questions
- ✅ **DO**: Use Context7 for library documentation (MudBlazor, MimeKit, etc.)
- ✅ **DO**: Add "use context7" to prompts about libraries
- ✅ **DO**: Use library ID syntax when you know the exact library (e.g., `/mudblazor/mudblazor`)
- ❌ **DON'T**: Rely on training data for library APIs
- ❌ **DON'T**: Use outdated library patterns

### For Stripe Integration
- ✅ **DO**: Use Stripe MCP tools for payment workflows
- ✅ **DO**: Verify webhook signatures methods
- ✅ **DO**: Check latest API versions and best practices
- ❌ **DON'T**: Use outdated Stripe patterns
- ❌ **DON'T**: Implement security-sensitive code without verification

## Encouraging Tool Usage

When answering questions related to:
- **Azure** → Always search Microsoft Learn first
- **.NET/C#** → Always search Microsoft Learn first
- **EF Core** → Microsoft Learn for concepts, Context7 for specific API usage
- **Blazor** → Microsoft Learn for framework, Context7 for component libraries
- **Azure Aspire** → Always search Microsoft Learn first
- **Azure Pricing** → Always use Azure Pricing MCP for cost decisions
- **Infrastructure Costs** → Always use Azure Pricing MCP
- **Service Selection** → Use Azure Pricing MCP to compare alternatives
- **Marketing Website** → Use Framer MCP (NOT for Blazor application)
- **Landing Pages** → Use Framer MCP for marketing site only
- **MudBlazor** → Always use Context7 (for Blazor application UI)
- **MimeKit** → Always use Context7
- **NuGet packages** → Use Context7 for library-specific docs
- **Stripe** → Use Stripe MCP tools first, Context7 for .NET SDK specifics

## Response Pattern

When user asks about these technologies:

1. **Acknowledge**: "Let me check the official Microsoft Learn documentation..."
2. **Search**: Use `microsoft_docs_search` or Stripe tools
3. **Verify**: Use `microsoft_docs_fetch` for detailed information
4. **Provide**: Give answer with reference to official docs
5. **Code Sample**: Use `microsoft_code_sample_search` if needed

**Example Flow**:
```
User: "How do I configure Azure Blob Storage in Aspire?"

AI: "Let me check the official Microsoft Learn documentation for Azure Aspire Blob Storage integration..."

[Uses microsoft_docs_search("Azure Aspire Blob Storage configuration")]
[Uses microsoft_docs_fetch(url from search results)]
[Uses microsoft_code_sample_search("Azure Aspire Blob Storage C#")]

AI: "According to the official Microsoft Learn documentation, here's how to configure Azure Blob Storage in Aspire..."
[Provides answer with official code samples]
```

## Tool Parameters

### microsoft_docs_search
- **query** (string): Search query for Microsoft documentation
- **Returns**: Relevant documentation snippets with URLs

### microsoft_docs_fetch
- **url** (string): Full URL to Microsoft Learn page
- **Returns**: Complete page content in markdown format

### microsoft_code_sample_search
- **query** (string): Search query for code samples
- **language** (optional): Filter by programming language (e.g., "csharp", "typescript")
- **Returns**: Official Microsoft/Azure code samples

### Stripe MCP Tools
- Various tools for customer, payment, subscription management
- All return structured Stripe API responses
- Use for any Stripe-related operations

## Fallback Strategy

If MCP tools are not available or return no results:
1. State that you're using training data
2. Recommend user verify against official docs
3. Provide standard answer with appropriate caveats

**Example**:
```
"While I cannot access the Microsoft Learn MCP server right now, based on my training data... 
However, I recommend verifying this against the official Microsoft Learn documentation at https://learn.microsoft.com/..."
```

## Querying Azure Pricing

You have access to the Azure Pricing MCP with tools for real-time Azure service pricing:
- `azure_price_search` - Search Azure retail prices with filters
- `azure_price_compare` - Compare prices across regions/SKUs
- `azure_cost_estimate` - Calculate estimated costs based on usage
- `azure_discover_skus` - Discover available SKUs for a service
- `azure_sku_discovery` - Intelligent SKU discovery with fuzzy matching

**ALWAYS use Azure Pricing MCP when making infrastructure decisions:**

### When to Use Azure Pricing MCP

**Use for**:
- Selecting Azure services (SQL vs PostgreSQL, Container Apps vs App Service)
- Comparing regions (West Europe vs North Europe)
- Estimating monthly infrastructure costs
- Validating business model (90%+ margin target, break-even at 7-20 customers)
- Finding cost-effective SKUs for specific workloads

**Example Prompts**:
```
"What's the cost of Azure SQL Serverless for a 10GB database in West Europe?"

"Compare App Service pricing between P1v3 and P2v3 in North Europe"

"Estimate storage costs for 500GB of email attachments with 100K reads per month"

"Find the cheapest Azure Container Apps plan for 24/7 background processing"

"Compare costs for all services between West Europe and North Europe regions"
```

## Framer MCP - Marketing Website Design

**CRITICAL**: Framer MCP is ONLY for the marketing website (evermail.com), NOT the Blazor application!

### When to Use Framer MCP

**Use for**:
- Marketing website design (evermail.com - landing pages, pricing, features)
- Public-facing marketing content
- Customer acquisition and conversion optimization
- A/B testing variations for marketing messaging

**NEVER use for**:
- ❌ Building the Blazor application UI (use MudBlazor)
- ❌ Email viewer interface (use Blazor components)
- ❌ Admin dashboard (use Blazor)
- ❌ Application-level components

**Example Prompts**:
```
"Create a modern SaaS landing page for Evermail marketing site with hero, features, and pricing"

"Design a pricing comparison table for the marketing website showing all subscription tiers"

"Update the marketing website CTA button color and text to emphasize free trial"

"Publish the marketing website homepage to production"

"Rewrite the marketing site hero headline to focus on AI-powered email search"
```

**Architecture Separation**:
- **Framer** → evermail.com (marketing)
- **Blazor** → app.evermail.com (application)

**Setup**: The Framer MCP plugin must be **open inside the Framer app** for the MCP to work.

## Integration with Evermail Project

For Evermail-specific implementations:
- **Always search Microsoft Learn** for Azure, .NET, Blazor core patterns
- **Always use Context7** for library documentation (MudBlazor, MimeKit, Azure SDKs)
- **Always use Stripe MCP** for payment integration code
- **Always use Azure Pricing MCP** for infrastructure cost decisions
- **Use Framer MCP ONLY** for marketing website (evermail.com), never for Blazor app
- **Fetch full documentation** when implementing critical features
- **Find official code samples** rather than creating from scratch
- **Verify best practices** against official sources

### Key Resources by MCP

**Microsoft Learn MCP**:
- Azure Aspire configuration
- ASP.NET Core patterns
- Entity Framework Core best practices
- Azure services setup (SQL, Blob Storage, etc.)

**Context7 MCP**:
1. **MudBlazor** (`/mudblazor/mudblazor`) - UI components
2. **MimeKit** (`/jstedfast/mimekit`) - Email parsing
3. **Azure.Storage.Blobs** - Blob storage operations
4. **Azure.Storage.Queues** - Queue operations
5. **Stripe.NET** (`/stripe/stripe-dotnet`) - Payment SDK
6. **Entity Framework Core** - Database operations

**Azure Pricing MCP**:
- Service cost comparisons
- Region pricing differences
- SKU discovery and selection
- Cost estimation and validation
- Break-even analysis

**Framer MCP**:
- Marketing website design (evermail.com)
- Landing page creation and updates
- Pricing page design
- Marketing content iteration
- Publishing marketing site
- **NOT for Blazor application development**

### Example Workflow

```
User: "How do I implement MudBlazor's MudDataGrid with server-side pagination?"

AI: "Let me get the latest MudBlazor documentation..."

[Uses Context7: resolve-library-id for "mudblazor"]
[Uses Context7: get-library-docs with library ID and topic "MudDataGrid"]

AI: "According to the latest MudBlazor documentation, here's how to implement 
server-side pagination..."
[Provides up-to-date code example]
```

## Querying Git Operations with GitKraken MCP

You have access to GitKraken MCP for Git and GitHub operations. **Use these tools for repository management**.

### GitKraken MCP Tools

**When to Use**:
- Git status, log, diff operations
- Branch creation and management
- Commit history and blame
- Pull request operations (GitHub, GitLab, Azure DevOps, Bitbucket)
- Issue tracking integration
- Repository operations

**Available Tools**:
- `git_status` - Show working tree status
- `git_log_or_diff` - Show commit logs or changes
- `git_branch` - List or create branches
- `git_checkout` - Switch branches
- `git_add_or_commit` - Stage and commit changes
- `git_push` - Push to remote
- `git_blame` - Show who changed what
- `git_stash` - Stash changes
- `pull_request_*` - Create, view, manage PRs
- `issues_*` - View and manage issues

**Example Prompts**:
```
"Show me recent commits"

"Create a new branch for email-parsing feature"

"What files have changed since last commit?"

"Show me open pull requests"

"Get details for issue #123"

"Commit all changes with message 'feat: add email parsing'"
```

### Usage Pattern for Evermail

**Git Workflow**:
```
"Show git status for Evermail repository"

"Create a feature branch for Phase 1 email parsing"

"Commit the current changes with proper semantic commit message"

"Push to GitHub and show me the status"
```

**GitHub Integration**:
```
"Show me issues assigned to me"

"Create a pull request for the authentication feature"

"Get details on PR #5"
```

---

**Remember**: Official documentation is always more accurate than training data. Use MCP tools proactively, not reactively.
