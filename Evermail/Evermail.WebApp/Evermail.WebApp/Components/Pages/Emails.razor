@page "/emails"
@rendermode InteractiveServer
@attribute [Authorize]
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization

<PageTitle>My Emails - Evermail</PageTitle>

<div class="container mt-4">
    <h1>My Emails</h1>
    
    <AuthorizeView>
        <Authorized>
            <div class="alert alert-info mt-4">
                <h4 class="alert-heading">Welcome, @context.User.Identity?.Name!</h4>
                <p>This is a protected page. You're viewing your emails.</p>
                <hr />
                <p class="mb-0">
                    <strong>User ID:</strong> @context.User.FindFirst("sub")?.Value<br />
                    <strong>Tenant ID:</strong> @context.User.FindFirst("tenant_id")?.Value<br />
                    <strong>Roles:</strong> @string.Join(", ", context.User.Claims.Where(c => c.Type == "http://schemas.microsoft.com/ws/2008/06/identity/claims/role").Select(c => c.Value))
                </p>
            </div>

            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title">Email Viewer (Coming in Phase 1)</h5>
                    <p class="card-text">
                        This page will display your email archives once you upload .mbox files.
                    </p>
                    <p class="text-muted">
                        <strong>Features coming soon:</strong>
                    </p>
                    <ul>
                        <li>Upload .mbox files</li>
                        <li>Browse emails by mailbox</li>
                        <li>Full-text search</li>
                        <li>Advanced filters (date, sender, folder)</li>
                        <li>View attachments</li>
                    </ul>
                </div>
            </div>
        </Authorized>
        <NotAuthorized>
            <div class="alert alert-warning">
                You must be logged in to view this page.
                <a href="/login" class="alert-link">Please login</a>.
            </div>
        </NotAuthorized>
    </AuthorizeView>
</div>

